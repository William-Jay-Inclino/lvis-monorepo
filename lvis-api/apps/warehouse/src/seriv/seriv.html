<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>{{title}}</title>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            font-size: 8.5pt;
            margin: 0;
            padding: 2px 12px 12px 12px;
            background: #fff; /* Changed from #f5f6fa to #fff */
            color: #222;
        }
        .org-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0;
        }
        .org-header img {
            height: 28px;
            width: 28px;
            margin-right: 8px;
        }
        .org-info {
            text-align: center;
            margin: 0;
            padding: 0;
        }
        .org-info .heading {
            font-size: 10pt;
            font-weight: bold;
            letter-spacing: 0.5px;
            margin: 0;
            padding: 0;
        }
        .org-info .sub {
            font-size: 7pt;
            color: #666;
            margin: 0;
            padding: 0;
        }
        .report-title {
            font-size: 9.5pt;
            font-weight: 600;
            text-align: center;
            margin: 2px 0 18px 0;
            letter-spacing: 0.2px;
        }
        .seriv-card {
            background: #fff;
            border-radius: 7px;
            box-shadow: 0 1px 4px rgba(60,60,60,0.07);
            border: 1px solid #e0e3ea;
            margin-bottom: 16px;
            padding: 14px 16px 10px 16px;
            page-break-inside: avoid;
        }
        .seriv-title {
            font-size: 9pt;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 6px;
            letter-spacing: 0.2px;
        }
        .seriv-meta {
            margin-bottom: 7px;
            font-size: 7.5pt;
            color: #444;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 2px 18px;
            width: 100%;
        }
        .seriv-meta span {
            margin-bottom: 1px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 2px;
            margin-bottom: 4px;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid #e5e7eb;
            padding: 3px 5px;
            text-align: left;
            font-size: 7.5pt;
            word-break: break-word;
        }
        th {
            background: #f3f4f6;
            color: #222;
            font-weight: 600;
            letter-spacing: 0.1px;
        }
        tfoot td {
            background: #f9fafb;
            font-weight: bold;
            color: #1a237e;
        }
        .grand-total-label {
            text-align: right;
        }
        /* Set equal width for all columns */
        .col-code { width: 14%; }
        .col-desc { width: 28%; }
        .col-unit { width: 10%; }
        .col-qty { width: 10%; }
        .col-price { width: 19%; }
        .col-total { width: 19%; }
    </style>
</head>
<body>
    <div class="org-header">
        {{#if logo}}
            <img src="data:image/jpeg;base64,{{logo}}" alt="Logo" />
        {{/if}}
        <div class="org-info">
            <div class="heading">LEYTE V ELECTRIC COOPERATIVE, INC.</div>
            <div class="sub">
                Brgy. San Pablo, Ormoc City, Leyte &nbsp;|&nbsp; VAT REG. TIN 001-383-331-000
            </div>
        </div>
    </div>
    <div class="report-title">
        {{title}}
    </div>

    {{#each serivs}}
        <div class="seriv-card">
            <div class="seriv-title">SERIV Number: {{@key}}</div>
            {{#each this}}
                <div class="seriv-meta">
                    <span>Date: {{formatDate date_requested}}</span>
                    <span>Purpose: {{na purpose}}</span>
                    <span>Consumer: {{na consumer_name}}</span>
                    <span>Location: {{na location}}</span>
                    <span>OR No.: {{na or_number}}</span>
                    <span>CWO No.: {{na cwo_number}}</span>
                    <span>Created By: {{na created_by}}</span>
                    <span>MWO No.: {{na mwo_number}}</span>
                    <span>JO No.: {{na jo_number}}</span>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th class="col-code">Item Code</th>
                            <th class="col-desc">Description</th>
                            <th class="col-unit">Unit</th>
                            <th class="col-qty">Qty</th>
                            <th class="col-price">Price</th>
                            <th class="col-total">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{#each seriv_items}}
                            <tr>
                                <td class="col-code">{{item.code}}</td>
                                <td class="col-desc">{{item.description}}</td>
                                <td class="col-unit">{{item.unit.name}}</td>
                                <td class="col-qty">{{quantity}}</td>
                                <td class="col-price">{{currency price}}</td>
                                <td class="col-total">{{currency (multiply price quantity)}}</td>
                            </tr>
                        {{/each}}
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="5" class="grand-total-label">Grand Total:</td>
                            <td>{{grandTotal seriv_items}}</td>
                        </tr>
                    </tfoot>
                </table>
            {{/each}}
        </div>
    {{/each}}
</body>
</html>